/* ============================================
   CATALOG MOBILE FIXES - 370px - 1206px
   Исправление проблем с выходом контента за экран
   ============================================ */

/* Базовые правила для всех мобильных устройств */
@media (max-width: 1206px) {
    /* Убираем любые overflow и гарантируем корректные размеры */
    html,
    body {
        overflow-x: hidden !important;
        max-width: 100vw !important;
        position: relative !important;
    }
    
    /* Каталог - основной контейнер */
    .catalog-page {
        overflow-x: hidden !important;
        max-width: 100% !important;
        width: 100% !important;
    }
    
    /* Container - корректные отступы */
    .catalog-page .container {
        padding-left: 1rem !important;
        padding-right: 1rem !important;
        max-width: 100% !important;
        width: 100% !important;
        margin: 0 auto !important;
        box-sizing: border-box !important;
    }
    
    /* Layout - убираем grid, делаем flex column */
    .catalog-layout {
        display: flex !important;
        flex-direction: column !important;
        width: 100% !important;
        max-width: 100% !important;
        overflow-x: hidden !important;
        gap: 1rem !important;
        padding: 0 !important;
        margin: 0 !important;
    }
    
    /* Content area - гарантируем 100% без переполнения */
    .content {
        width: 100% !important;
        max-width: 100% !important;
        min-width: 0 !important;
        overflow-x: hidden !important;
        padding: 0 !important;
        margin: 0 !important;
        box-sizing: border-box !important;
    }
    
    /* Products grid - адаптивная сетка */
    .products,
    .products-grid,
    #products {
        width: 100% !important;
        max-width: 100% !important;
        overflow-x: hidden !important;
        display: grid !important;
        gap: 1rem !important;
        padding: 0 !important;
        margin: 0 !important;
        box-sizing: border-box !important;
    }
    
    /* Quick filters - горизонтальный скролл */
    .quick-filters-bar,
    .quick-filters-sizes,
    .sizes-scroll-container {
        width: 100% !important;
        max-width: 100% !important;
        overflow-x: auto !important;
        overflow-y: hidden !important;
        -webkit-overflow-scrolling: touch !important;
        padding: 0.5rem 0 !important;
        margin: 0 !important;
    }
    
    .quick-filters-bar::-webkit-scrollbar,
    .quick-filters-sizes::-webkit-scrollbar {
        height: 4px;
    }
    
    .quick-filters-bar::-webkit-scrollbar-thumb,
    .quick-filters-sizes::-webkit-scrollbar-thumb {
        background: #d1d5db;
        border-radius: 2px;
    }
    
    /* Product cards - корректные размеры */
    .product-card,
    .product {
        width: 100% !important;
        max-width: 100% !important;
        box-sizing: border-box !important;
        overflow: hidden !important;
    }
    
    .product-image,
    .product-image-wrapper {
        width: 100% !important;
        max-width: 100% !important;
        overflow: hidden !important;
    }
    
    .product-image img {
        width: 100% !important;
        height: auto !important;
        object-fit: cover !important;
    }
}

/* Очень маленькие экраны: 370px - 480px */
@media (max-width: 480px) {
    .catalog-page .container {
        padding-left: 0.75rem !important;
        padding-right: 0.75rem !important;
    }
    
    .products,
    .products-grid,
    #products {
        grid-template-columns: repeat(2, 1fr) !important;
        gap: 0.75rem !important;
    }
    
    /* Уменьшаем отступы для карточек */
    .product-card {
        padding: 0 !important;
    }
    
    .product-info,
    .product-card-body {
        padding: 0.5rem !important;
    }
}

/* Маленькие телефоны: 481px - 639px */
@media (min-width: 481px) and (max-width: 639px) {
    .products,
    .products-grid,
    #products {
        grid-template-columns: repeat(2, 1fr) !important;
        gap: 1rem !important;
    }
}

/* Средние экраны (планшеты вертикально): 640px - 767px */
@media (min-width: 640px) and (max-width: 767px) {
    .products,
    .products-grid,
    #products {
        grid-template-columns: repeat(3, 1fr) !important;
        gap: 1rem !important;
    }
}

/* Планшеты: 768px - 1023px */
@media (min-width: 768px) and (max-width: 1023px) {
    .catalog-page .container {
        padding-left: 1.5rem !important;
        padding-right: 1.5rem !important;
    }
    
    .products,
    .products-grid,
    #products {
        grid-template-columns: repeat(3, 1fr) !important;
        gap: 1.25rem !important;
    }
}

/* Маленькие ноутбуки: 1024px - 1206px */
@media (min-width: 1024px) and (max-width: 1206px) {
    .catalog-page .container {
        padding-left: 2rem !important;
        padding-right: 2rem !important;
    }
    
    .products,
    .products-grid,
    #products {
        grid-template-columns: repeat(4, 1fr) !important;
        gap: 1.5rem !important;
    }
}

/* Sidebar - ВСЕГДА fixed overlay на этих разрешениях */
@media (max-width: 1206px) {
    .sidebar {
        position: fixed !important;
        top: 0 !important;
        left: -100% !important;
        width: 85% !important;
        max-width: 420px !important;
        height: 100vh !important;
        height: 100dvh !important; /* Dynamic viewport height для мобильных */
        z-index: 9999 !important;
        background: #fff !important;
        overflow-y: auto !important;
        overflow-x: hidden !important;
        transition: left 0.3s ease-in-out !important;
        box-shadow: 4px 0 20px rgba(0, 0, 0, 0.2) !important;
    }
    
    .sidebar.active,
    .sidebar.open {
        left: 0 !important;
    }
    
    /* Overlay для sidebar */
    .sidebar-overlay,
    .overlay {
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        width: 100vw !important;
        height: 100vh !important;
        height: 100dvh !important;
        background: rgba(0, 0, 0, 0.5) !important;
        z-index: 9998 !important;
        opacity: 0 !important;
        pointer-events: none !important;
        transition: opacity 0.3s ease-in-out !important;
    }
    
    .sidebar-overlay.active,
    .overlay.active {
        opacity: 1 !important;
        pointer-events: all !important;
    }
}

/* Breadcrumbs - горизонтальный скролл */
@media (max-width: 1206px) {
    .breadcrumbs {
        overflow-x: auto !important;
        overflow-y: hidden !important;
        white-space: nowrap !important;
        -webkit-overflow-scrolling: touch !important;
        padding: 0.75rem 0 !important;
    }
    
    .breadcrumbs::-webkit-scrollbar {
        height: 3px;
    }
    
    .breadcrumbs::-webkit-scrollbar-thumb {
        background: #d1d5db;
        border-radius: 1.5px;
    }
}

/* Catalog header - корректное выравнивание */
@media (max-width: 1206px) {
    .catalog-header,
    .content-header {
        width: 100% !important;
        max-width: 100% !important;
        overflow-x: hidden !important;
        padding: 0 !important;
        margin-bottom: 1rem !important;
    }
    
    .catalog-toolbar {
        display: flex !important;
        flex-wrap: wrap !important;
        gap: 0.75rem !important;
        width: 100% !important;
        max-width: 100% !important;
        overflow-x: hidden !important;
    }
}

/* Пагинация - адаптивная */
@media (max-width: 1206px) {
    .pagination {
        display: flex !important;
        justify-content: center !important;
        flex-wrap: wrap !important;
        gap: 0.5rem !important;
        padding: 1rem 0 !important;
        width: 100% !important;
        max-width: 100% !important;
        overflow-x: hidden !important;
    }
    
    .pagination a,
    .pagination span {
        min-width: 40px !important;
        height: 40px !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
    }
}

/* Footer - корректные отступы */
@media (max-width: 1206px) {
    .site-footer .container {
        padding-left: 1rem !important;
        padding-right: 1rem !important;
    }
}

/* Критично: запрещаем любые элементы выходить за 100vw */
@media (max-width: 1206px) {
    * {
        max-width: 100% !important;
    }
    
    /* Исключения для элементов, которым нужна фиксированная ширина */
    .sidebar,
    .sidebar-overlay,
    .overlay,
    img,
    svg {
        max-width: none !important;
    }
    
    img {
        max-width: 100% !important;
        height: auto !important;
    }
}
