# üìã –ü–ª–∞–Ω –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—Å–µ—Ö –ø—Ä–æ–±–ª–µ–º

**–î–∞—Ç–∞**: 05.11.2024, 06:49

---

## ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û

### 1. ‚úÖ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: sort_order

```sql
ALTER TABLE product_size ADD COLUMN sort_order INT DEFAULT 0 AFTER id;
CREATE INDEX idx_product_size_sort ON product_size(sort_order);
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –û—à–∏–±–∫–∞ "Unknown column 'sort_order'" –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞!

---

### 2. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è —Ü–µ–Ω –≤ product_size

```sql
ALTER TABLE product_size 
ADD COLUMN price_cny DECIMAL(10,2) COMMENT '–¶–µ–Ω–∞ –≤ —é–∞–Ω—è—Ö' AFTER price,
ADD COLUMN price_byn DECIMAL(10,2) COMMENT '–¶–µ–Ω–∞ –≤ BYN' AFTER price_cny,
ADD COLUMN price_client_byn DECIMAL(10,2) COMMENT '–¶–µ–Ω–∞ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞' AFTER price_byn;
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å 3 —Ü–µ–Ω—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞!

---

## üîß –ù–£–ñ–ù–û –ò–°–ü–†–ê–í–ò–¢–¨

### 3. ‚ö†Ô∏è –î—É–±–ª–∏—Ä—É—é—â–∏–µ –±–ª–æ–∫–∏ –≤ edit-product.php

**–ü—Ä–æ–±–ª–µ–º–∞**: 
- –ë–ª–æ–∫ "–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è" –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è 2 —Ä–∞–∑–∞ (—Å—Ç—Ä–æ–∫–∏ 235-268 –∏ 669-697)
- –ë–ª–æ–∫ "–†–∞–∑–º–µ—Ä—ã —Ç–æ–≤–∞—Ä–∞" –¥—É–±–ª–∏—Ä—É–µ—Ç—Å—è (—Å—Ç—Ä–æ–∫–∞ 640-665)

**–†–µ—à–µ–Ω–∏–µ**: –£–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏ –≤ —Å—Ç—Ä–æ–∫–∞—Ö 640-697

---

### 4. ‚ö†Ô∏è –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –≤ meta_keywords

**–ü—Ä–æ–±–ª–µ–º–∞**: keywords –∏–∑ JSON –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ meta_keywords

**–†–µ—à–µ–Ω–∏–µ**: 
```php
// –í PoizonImportJsonController.php
if (!empty($data['keywords'])) {
    $product->meta_keywords = is_array($data['keywords']) 
        ? implode(', ', $data['keywords']) 
        : $data['keywords'];
}
```

---

### 5. ‚ö†Ô∏è –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –¥–æ–ª–∂–Ω—ã –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å–∏—Å—Ç–µ–º–æ–π

**–ü—Ä–æ–±–ª–µ–º–∞**: –°–µ–π—á–∞—Å —Å–æ–∑–¥–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ `product_characteristic`, –Ω–æ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å–∏—Å—Ç–µ–º—É

**–¢–µ–∫—É—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞**:
- product_characteristic (–ù–û–í–ê–Ø - –¥–ª—è Poizon)
- ??? (—Å—É—â–µ—Å—Ç–≤—É—é—â–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫)

**–ù—É–∂–Ω–æ**:
- –ù–∞–π—Ç–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å–∏—Å—Ç–µ–º—É —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–º–ø–æ—Ä—Ç Poizon —Å –Ω–µ–π
- –°–æ–∑–¥–∞—Ç—å —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏

---

### 6. ‚ö†Ô∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–Ω–æ–π —Å–µ—Ç–∫–∏

**–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–º–µ—Ä—ã –ø–æ—Å–ª–µ –∏–º–ø–æ—Ä—Ç–∞

**–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ä–º—É —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –º–æ–¥–∞–ª "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–º–µ—Ä"

---

### 7. ‚ö†Ô∏è –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ü–µ–Ω –≤ product_size –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ

**–ü—Ä–æ–±–ª–µ–º–∞**: –ù–æ–≤—ã–µ –ø–æ–ª—è price_cny, price_byn, price_client_byn –Ω–µ –∑–∞–ø–æ–ª–Ω—è—é—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ**:
```php
// –í importSizes()
$size->price_cny = $childData['purchasePrice'] ?? null;
$size->price_byn = $this->convertCnyToByn($size->price_cny);
$size->price_client_byn = $this->calculateClientPrice($size->price_byn);
```

---

### 8. ‚ö†Ô∏è –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫

**–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏

**–†–µ—à–µ–Ω–∏–µ**: –°–æ–∑–¥–∞—Ç—å:
- –¢–∞–±–ª–∏—Ü—É `characteristic` (—Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫)
- –¢–∞–±–ª–∏—Ü—É `characteristic_value` (–∑–Ω–∞—á–µ–Ω–∏—è)
- –°–≤—è–∑—å many-to-many —á–µ—Ä–µ–∑ `product_characteristic_value`

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞**:
```sql
CREATE TABLE characteristic (
    id INT PRIMARY KEY,
    name VARCHAR(255),
    type ENUM('select', 'text', 'number'),
    is_filter BOOLEAN,
    sort_order INT
);

CREATE TABLE characteristic_value (
    id INT PRIMARY KEY,
    characteristic_id INT,
    value VARCHAR(255),
    sort_order INT
);

CREATE TABLE product_characteristic_value (
    product_id INT,
    characteristic_id INT,
    characteristic_value_id INT,
    value TEXT,  -- –¥–ª—è type='text'
    PRIMARY KEY (product_id, characteristic_id)
);
```

---

## üìä –ü–†–ò–û–†–ò–¢–ï–¢–´

### üî¥ –ö—Ä–∏—Ç–∏—á–Ω–æ (—Å–µ–π—á–∞—Å):
1. ‚úÖ ~~–û—à–∏–±–∫–∞ sort_order~~ - –ò–°–ü–†–ê–í–õ–ï–ù–û
2. ‚ö†Ô∏è –£–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏ –±–ª–æ–∫–æ–≤
3. ‚ö†Ô∏è Keywords ‚Üí meta_keywords
4. ‚ö†Ô∏è –ó–∞–ø–æ–ª–Ω–∏—Ç—å price_cny, price_byn, price_client_byn

### üü° –í–∞–∂–Ω–æ (—Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥):
5. ‚ö†Ô∏è –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
6. ‚ö†Ô∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤
7. ‚ö†Ô∏è –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫

---

## üöÄ –î–ï–ô–°–¢–í–ò–Ø

### –°–µ–π—á–∞—Å –¥–µ–ª–∞—é:
1. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å edit-product.php (—É–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏)
2. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç (keywords, —Ü–µ–Ω—ã)
3. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç

### –ü–æ—Ç–æ–º:
4. –°–æ–∑–¥–∞—Ç—å —Å–∏—Å—Ç–µ–º—É —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤
5. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
6. –î–æ–±–∞–≤–∏—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤
