# üöÄ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Poizon/Dewu - –ü–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–í–≤–µ–¥–µ–Ω–∏–µ](#–≤–≤–µ–¥–µ–Ω–∏–µ)
2. [–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Ä–∞–±–æ—Ç–µ](#–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–∫-—Ä–∞–±–æ—Ç–µ)
3. [–ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫](#–ø–µ—Ä–≤—ã–π-–∑–∞–ø—É—Å–∫)
4. [–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è (Cron)](#–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è-cron)
5. [–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É](#—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ-—á–µ—Ä–µ–∑-–∞–¥–º–∏–Ω–∫—É)
6. [API –¥–ª—è real-time –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–∑–º–µ—Ä–æ–≤](#api-–¥–ª—è-real-time-–ø—Ä–æ–≤–µ—Ä–∫–∏-—Ä–∞–∑–º–µ—Ä–æ–≤)
7. [–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏](#–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–∏-–ª–æ–≥–∏)
8. [–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º](#—Ä–µ—à–µ–Ω–∏–µ-–ø—Ä–æ–±–ª–µ–º)

---

## –í–≤–µ–¥–µ–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∏–º–ø–æ—Ä—Ç–∞ —Ç–æ–≤–∞—Ä–æ–≤ –∏–∑ Poizon/Dewu —Å –ø–æ–ª–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π:

- ‚úÖ –ò–º–ø–æ—Ä—Ç –≤—Å–µ—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –æ–±—É–≤–∏
- ‚úÖ –†–∞–∑–º–µ—Ä–Ω—ã–µ —Å–µ—Ç–∫–∏ (US, EU, UK, CM)
- ‚úÖ –§–æ—Ä–º—É–ª–∞ —Ü–µ–Ω: `CNY √ó –∫—É—Ä—Å √ó 1.5 + 40 BYN`
- ‚úÖ CDN –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è Poizon
- ‚úÖ –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–∞–∑ –≤ —Å—É—Ç–∫–∏
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–µ—Ç—Ä–∏–∫–∏
- ‚úÖ –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

---

## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Ä–∞–±–æ—Ç–µ

### 1. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î

```bash
cd /path/to/project
php yii migrate
```

–ü—Ä–∏–º–µ–Ω—è—Ç—Å—è 3 –Ω–æ–≤—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏:
- `m251104_120000_add_poizon_fields_to_product` - –ü–æ–ª—è Poizon –≤ —Ç–∞–±–ª–∏—Ü–µ —Ç–æ–≤–∞—Ä–æ–≤
- `m251104_120100_update_product_size_with_grids` - –†–∞–∑–º–µ—Ä–Ω—ã–µ —Å–µ—Ç–∫–∏
- `m251104_120200_create_import_tables` - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–º–ø–æ—Ä—Ç–∞

### 2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ `config/params.php`

```php
// –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Poizon/Dewu API
'poizonApiUrl' => 'https://api.poizon-parser.com/v1', // URL —Å—Ç–æ—Ä–æ–Ω–Ω–µ–≥–æ API (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
'poizonApiKey' => '–≤–∞—à_api_–∫–ª—é—á', // API –∫–ª—é—á (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è)
'poizonXmlUrl' => 'https://s3.q-parser.ru/export/xxx/poizon.xml', // URL XML —Ñ–∏–¥–∞

// –ö—É—Ä—Å CNY -> BYN
'cnyToBynRate' => 0.45, // –û–±–Ω–æ–≤–ª—è–π—Ç–µ –∫—É—Ä—Å –≤—Ä—É—á–Ω—É—é –∏–ª–∏ —á–µ—Ä–µ–∑ API
```

**–í–∞–∂–Ω–æ:** –ï—Å–ª–∏ —É –≤–∞—Å **–Ω–µ—Ç –≥–æ—Ç–æ–≤–æ–≥–æ API**, –µ—Å—Ç—å 3 –≤–∞—Ä–∏–∞–Ω—Ç–∞:

#### –í–∞—Ä–∏–∞–Ω—Ç 1: XML —Ñ–∏–¥ –æ—Ç –ø–∞—Ä—Å–µ—Ä–∞
–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ XML —Ñ–∏–¥—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç —Å–µ—Ä–≤–∏—Å–æ–≤ —Ç–∏–ø–∞ q-parser.ru):
```php
'poizonXmlUrl' => 'https://–≤–∞—à-–¥–æ–º–µ–Ω.ru/poizon-feed.xml',
```

#### –í–∞—Ä–∏–∞–Ω—Ç 2: –°—Ç–æ—Ä–æ–Ω–Ω–∏–π API –ø–∞—Ä—Å–∏–Ω–≥–∞
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–µ—Ä–≤–∏—Å—ã —Ç–∏–ø–∞:
- DewuParser API
- Poizon Parser Service
- –î—Ä—É–≥–∏–µ —Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ —Ä–µ—à–µ–Ω–∏—è

#### –í–∞—Ä–∏–∞–Ω—Ç 3: –°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–∞—Ä—Å–µ—Ä
–†–∞–∑—Ä–∞–±–æ—Ç–∞–π—Ç–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–∞—Ä—Å–µ—Ä —Å–∞–π—Ç–∞ Poizon (—Ç—Ä–µ–±—É–µ—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –∑–Ω–∞–Ω–∏–π).

### 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

```bash
php yii poizon-import/test
```

–í—ã —É–≤–∏–¥–∏—Ç–µ:
```
üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Poizon API...

‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ!
–ù–∞–π–¥–µ–Ω–æ —Ç–æ–≤–∞—Ä–æ–≤: 1234
```

---

## –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫

### –ö–æ–Ω—Å–æ–ª—å–Ω—ã–π –∏–º–ø–æ—Ä—Ç (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ —Ä–∞–∑–∞)

```bash
# –ò–º–ø–æ—Ä—Ç 100 —Ç–æ–≤–∞—Ä–æ–≤ (–¥–ª—è —Ç–µ—Å—Ç–∞)
php yii poizon-import/run --limit=100

# –ü–æ–ª–Ω—ã–π –∏–º–ø–æ—Ä—Ç (–≤—Å–µ —Ç–æ–≤–∞—Ä—ã)
php yii poizon-import/run --limit=0

# –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º (–±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –ë–î)
php yii poizon-import/run --limit=50 --dryRun=1
```

### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ:

1. **–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö** –∏–∑ Poizon API
2. **–°–æ–∑–¥–∞–Ω–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤**:
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ SKU: `POIZON-{BRAND}-{STYLE_CODE}`
   - –†–∞—Å—á–µ—Ç —Ü–µ–Ω—ã: `CNY √ó 0.45 √ó 1.5 + 40 BYN`
   - –°—Ç–∞—Ç—É—Å: "–ü–æ–¥ –∑–∞–∫–∞–∑" (14-30 –¥–Ω–µ–π)
3. **–ò–º–ø–æ—Ä—Ç —Ä–∞–∑–º–µ—Ä–æ–≤**:
   - –í—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã
   - –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ US/EU/UK/CM
4. **–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –æ–±—É–≤–∏**:
   - –ú–∞—Ç–µ—Ä–∏–∞–ª –≤–µ—Ä—Ö–∞/–ø–æ–¥–æ—à–≤—ã
   - –¶–≤–µ—Ç, —Å—Ç–∏–ª—å, –≥–æ–¥ –≤—ã–ø—É—Å–∫–∞
   - –ü–æ–ª, —Å–µ–∑–æ–Ω, –≤—ã—Å–æ—Ç–∞
5. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π

### –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:

```
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë  üöÄ –ò–ú–ü–û–†–¢ –¢–û–í–ê–†–û–í –ò–ó POIZON/DEWU                  ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

üì° –ó–∞–≥—Ä—É–∂–∞—é –¥–∞–Ω–Ω—ã–µ –∏–∑ Poizon...
‚úÖ –ü–æ–ª—É—á–µ–Ω–æ —Ç–æ–≤–∞—Ä–æ–≤: 1234

üîÑ –ò–º–ø–æ—Ä—Ç–∏—Ä—É—é —Ç–æ–≤–∞—Ä—ã...

‚úÖ ‚úÖ ‚úÖ üîÑ ‚úÖ ‚è≠Ô∏è ‚úÖ ‚úÖ ‚úÖ ‚úÖ  50/1234 (4.1%)
‚úÖ ‚úÖ ‚úÖ ‚úÖ ‚úÖ ‚úÖ ‚úÖ ‚úÖ ‚úÖ ‚úÖ  100/1234 (8.1%)
...

‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë  üìä –ò–¢–û–ì–ò –ò–ú–ü–û–†–¢–ê                                  ‚ïë
‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
‚ïë  ‚úÖ –°–æ–∑–¥–∞–Ω–æ:      1089                              ‚ïë
‚ïë  üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–æ:    123                               ‚ïë
‚ïë  ‚è≠Ô∏è  –ü—Ä–æ–ø—É—â–µ–Ω–æ:   15                                ‚ïë
‚ïë  ‚ùå –û—à–∏–±–æ–∫:       7                                 ‚ïë
‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
‚ïë  üì¶ –í—Å–µ–≥–æ:        1234                              ‚ïë
‚ïë  ‚è±Ô∏è  –í—Ä–µ–º—è:        5 –º–∏–Ω 23 —Å–µ–∫                     ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
```

---

## –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è (Cron)

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –∏–º–ø–æ—Ä—Ç–∞

–°–æ–∑–¥–∞–π—Ç–µ cron –∑–∞–¥–∞—á—É –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∏–º–ø–æ—Ä—Ç–∞ —Ä–∞–∑ –≤ —Å—É—Ç–∫–∏.

#### 1. –û—Ç–∫—Ä–æ–π—Ç–µ crontab:
```bash
crontab -e
```

#### 2. –î–æ–±–∞–≤—å—Ç–µ –∑–∞–¥–∞—á—É (–∑–∞–ø—É—Å–∫ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 3:00 –Ω–æ—á–∏):
```bash
0 3 * * * cd /path/to/project && php yii poizon-import/run --limit=0 >> /path/to/project/runtime/logs/poizon-import.log 2>&1
```

#### 3. –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è:

```bash
# –ö–∞–∂–¥—ã–µ 12 —á–∞—Å–æ–≤
0 */12 * * * cd /path/to/project && php yii poizon-import/run --limit=0

# –ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 2:00 –Ω–æ—á–∏
0 2 * * * cd /path/to/project && php yii poizon-import/run --limit=0

# –ö–∞–∂–¥—ã–π –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ –≤ 4:00 —É—Ç—Ä–∞
0 4 * * 1 cd /path/to/project && php yii poizon-import/run --limit=0
```

#### 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É cron:
```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
tail -f /path/to/project/runtime/logs/poizon-import.log

# –°–ø–∏—Å–æ–∫ cron –∑–∞–¥–∞—á
crontab -l
```

### –ì–æ—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç `poizon-import-cron.sh`:

```bash
#!/bin/bash
cd /path/to/project
php yii poizon-import/run --limit=0
```

–°–¥–µ–ª–∞–π—Ç–µ –µ–≥–æ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º:
```bash
chmod +x poizon-import-cron.sh
```

---

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É

### –î–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ –∏–º–ø–æ—Ä—Ç–∞

URL: `https://–≤–∞—à-–¥–æ–º–µ–Ω.by/admin-import`

**–¢—Ä–µ–±—É–µ—Ç—Å—è:** —Ä–æ–ª—å `admin`

### –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∞–¥–º–∏–Ω–∫–∏:

1. **Dashboard** (`/admin-import/index`):
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤—Å–µ—Ö –∏–º–ø–æ—Ä—Ç–æ–≤
   - –ü–æ—Å–ª–µ–¥–Ω–∏–π –∏–º–ø–æ—Ä—Ç
   - –ò—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö –±–∞—Ç—á–µ–π

2. **–ó–∞–ø—É—Å–∫ –∏–º–ø–æ—Ä—Ç–∞** (`/admin-import/run`):
   - –í—ã–±–æ—Ä –ª–∏–º–∏—Ç–∞ —Ç–æ–≤–∞—Ä–æ–≤
   - –ó–∞–ø—É—Å–∫ –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ
   - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å—Ç–∞—Ç—É—Å–∞

3. **–î–µ—Ç–∞–ª–∏ –∏–º–ø–æ—Ä—Ç–∞** (`/admin-import/view?id=123`):
   - –ü–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–∞—Ç—á–µ
   - –õ–æ–≥–∏ –∫–∞–∂–¥–æ–≥–æ —Ç–æ–≤–∞—Ä–∞
   - –û—à–∏–±–∫–∏ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

4. **–õ–æ–≥–∏ –æ—à–∏–±–æ–∫** (`/admin-import/errors`):
   - –í—Å–µ –æ—à–∏–±–∫–∏ –∏–º–ø–æ—Ä—Ç–∞
   - –î–µ—Ç–∞–ª–∏ –∫–∞–∂–¥–æ–π –æ—à–∏–±–∫–∏
   - –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏–º–ø–æ—Ä—Ç–∞

### –°–∫—Ä–∏–Ω—à–æ—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞:

**Dashboard:**
- –ö–∞—Ä—Ç–æ—á–∫–∏ —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
- –ì—Ä–∞—Ñ–∏–∫ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏
- –ü–æ—Å–ª–µ–¥–Ω–∏–π –∏–º–ø–æ—Ä—Ç

**–î–µ—Ç–∞–ª–∏ –±–∞—Ç—á–∞:**
- –í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞/–∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö/–æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö
- –°–ø–∏—Å–æ–∫ –ª–æ–≥–æ–≤

---

## API –¥–ª—è real-time –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–∑–º–µ—Ä–æ–≤

–ü—Ä–∏ –≤—ã–±–æ—Ä–µ —Ä–∞–∑–º–µ—Ä–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Ç–æ–≤–∞—Ä–∞ —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω–æ–µ –Ω–∞–ª–∏—á–∏–µ –≤ Poizon.

### Endpoint:

```
GET /admin-import/check-size?poizonSkuId={sku_id}
```

### Response:

```json
{
  "success": true,
  "available": true,
  "stock": 5,
  "price_cny": 899,
  "delivery_days": "14-30"
}
```

### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ JS:

```javascript
// –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Ç–æ–≤–∞—Ä–∞
$('.size-selector').on('click', function() {
    var poizonSkuId = $(this).data('poizon-sku-id');
    
    $.get('/admin-import/check-size', { poizonSkuId: poizonSkuId }, function(data) {
        if (data.success && data.available) {
            $('#availability').text('–î–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –∑–∞–∫–∞–∑–∞');
            $('#delivery-time').text('–î–æ—Å—Ç–∞–≤–∫–∞: ' + data.delivery_days + ' –¥–Ω–µ–π');
        } else {
            $('#availability').text('–í—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω');
        }
    });
});
```

---

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏

### 1. –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –∏–º–ø–æ—Ä—Ç–∞

```bash
# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 10 –∏–º–ø–æ—Ä—Ç–æ–≤
php yii poizon-import/logs

# –î–µ—Ç–∞–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∏–º–ø–æ—Ä—Ç–∞
php yii poizon-import/logs 123
```

### 2. –õ–æ–≥–∏ –≤ —Ñ–∞–π–ª–∞—Ö

- **–û—Å–Ω–æ–≤–Ω—ã–µ –ª–æ–≥–∏:** `runtime/logs/app.log`
- **–õ–æ–≥–∏ –∏–º–ø–æ—Ä—Ç–∞:** `runtime/logs/poizon-import.log` (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω cron)
- **–õ–æ–≥–∏ –æ—à–∏–±–æ–∫:** `runtime/logs/error.log`

### 3. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

**–¢–∞–±–ª–∏—Ü—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:**

- `import_batch` - –ö–∞–∂–¥—ã–π –∑–∞–ø—É—Å–∫ –∏–º–ø–æ—Ä—Ç–∞
- `import_log` - –î–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ –ø–æ –∫–∞–∂–¥–æ–º—É —Ç–æ–≤–∞—Ä—É

**SQL –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:**

```sql
-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ 10 –∏–º–ø–æ—Ä—Ç–æ–≤
SELECT * FROM import_batch ORDER BY created_at DESC LIMIT 10;

-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏
SELECT 
    status,
    COUNT(*) as count,
    AVG(duration_seconds) as avg_duration,
    SUM(created_count) as total_created,
    SUM(error_count) as total_errors
FROM import_batch 
GROUP BY status;

-- –¢–æ–ø –æ—à–∏–±–æ–∫
SELECT 
    message,
    COUNT(*) as count
FROM import_log 
WHERE action = 'error'
GROUP BY message
ORDER BY count DESC
LIMIT 10;
```

### 4. –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

- **–°–∫–æ—Ä–æ—Å—Ç—å –∏–º–ø–æ—Ä—Ç–∞:** ~200-300 —Ç–æ–≤–∞—Ä–æ–≤/–º–∏–Ω
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏:** ~50-100 MB
- **–ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –ë–î:** –°—Ä–µ–¥–Ω—è—è

---

## –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### ‚ùå –û—à–∏–±–∫–∞: "Poizon API Error"

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω URL API –∏–ª–∏ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `config/params.php`:
   ```php
   'poizonXmlUrl' => 'https://–≤–∞—à-url.xml',
   ```
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ URL –¥–æ—Å—Ç—É–ø–µ–Ω:
   ```bash
   curl -I https://–≤–∞—à-url.xml
   ```
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `runtime/logs/app.log`

---

### ‚ùå –û—à–∏–±–∫–∞: "Failed to load XML feed"

**–ü—Ä–∏—á–∏–Ω–∞:** XML —Ñ–∏–¥ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –∏–ª–∏ –Ω–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ XML –≤—Ä—É—á–Ω—É—é –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ (–µ—Å–ª–∏ –ª–æ–∫–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª)
3. –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã XML

---

### ‚ùå –û—à–∏–±–∫–∞: "Validation error"

**–ü—Ä–∏—á–∏–Ω–∞:** –î–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä–∞ –Ω–µ –ø—Ä–æ—à–ª–∏ –≤–∞–ª–∏–¥–∞—Ü–∏—é –º–æ–¥–µ–ª–∏

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –¥–µ—Ç–∞–ª–∏ –≤ –ª–æ–≥–∞—Ö:
   ```bash
   php yii poizon-import/logs {batch_id}
   ```
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è: name, brand_id, category_id, price
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±—Ä–µ–Ω–¥—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

### ‚ö†Ô∏è  –ò–º–ø–æ—Ä—Ç –º–µ–¥–ª–µ–Ω–Ω—ã–π

**–ü—Ä–∏—á–∏–Ω—ã –∏ —Ä–µ—à–µ–Ω–∏—è:**

1. **–ë–æ–ª—å—à–æ–π –ª–∏–º–∏—Ç —Ç–æ–≤–∞—Ä–æ–≤** - –£–º–µ–Ω—å—à–∏—Ç–µ `--limit`
2. **–ú–µ–¥–ª–µ–Ω–Ω—ã–π API** - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
3. **–ú–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π** - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ CDN –≤–º–µ—Å—Ç–æ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**
```bash
# –†–∞–∑–±–µ–π—Ç–µ –Ω–∞ —á–∞—Å—Ç–∏
php yii poizon-import/run --limit=500  # –ü–µ—Ä–≤–∞—è —á–∞—Å—Ç—å
php yii poizon-import/run --limit=500  # –í—Ç–æ—Ä–∞—è —á–∞—Å—Ç—å
```

---

### ‚ö†Ô∏è  –î—É–±–ª–∏–∫–∞—Ç—ã —Ç–æ–≤–∞—Ä–æ–≤

**–ü—Ä–∏—á–∏–Ω–∞:** SKU –Ω–µ —É–Ω–∏–∫–∞–ª–µ–Ω –∏–ª–∏ –ø–æ–ª–µ `poizon_id` –¥—É–±–ª–∏—Ä—É–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å SKU –≤ –ë–î:
   ```sql
   SELECT sku, COUNT(*) FROM product GROUP BY sku HAVING COUNT(*) > 1;
   ```
2. –£–¥–∞–ª–∏—Ç–µ –¥—É–±–ª–∏–∫–∞—Ç—ã –≤—Ä—É—á–Ω—É—é –∏–ª–∏ —á–µ—Ä–µ–∑ –º–∏–≥—Ä–∞—Ü–∏—é

---

### ‚ö†Ô∏è  –ù–µ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è —Ä–∞–∑–º–µ—Ä—ã

**–ü—Ä–∏—á–∏–Ω–∞:** –†–∞–∑–º–µ—Ä –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω –∏–ª–∏ –Ω–µ—Ç –≤ —Ç–∞–±–ª–∏—Ü–µ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç —Ä–∞–∑–º–µ—Ä–æ–≤ –≤ –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
2. –î–æ–ø–æ–ª–Ω–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—É –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –≤ `PoizonApiService::convertSize()`

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –≤–æ–ø—Ä–æ—Å—ã:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `php yii poizon-import/logs`
2. –û—Ç–∫—Ä–æ–π—Ç–µ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å: `/admin-import`
3. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –¥–µ—Ç–∞–ª–∏ –æ—à–∏–±–æ–∫ –≤ –ë–î (`import_log`)

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –û–±–Ω–æ–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ —Ü–µ–Ω—ã (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)
php yii poizon-import/update-prices

# –û–±–Ω–æ–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ —Ä–∞–∑–º–µ—Ä—ã (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)
php yii poizon-import/update-sizes

# –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–æ–≤–∞—Ä—ã (–û–°–¢–û–†–û–ñ–ù–û!)
php yii import/clear

# –¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
php yii poizon-import/test

# –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–º–æ—â—å
php yii help poizon-import
```

---

## ‚úÖ –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è

- [ ] –ü—Ä–∏–º–µ–Ω–µ–Ω—ã –≤—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ `params.php`
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ: `php yii poizon-import/test`
- [ ] –í—ã–ø–æ–ª–Ω–µ–Ω –ø–µ—Ä–≤—ã–π –∏–º–ø–æ—Ä—Ç: `php yii poizon-import/run --limit=100`
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω—ã —Ç–æ–≤–∞—Ä—ã –≤ –∞–¥–º–∏–Ω–∫–µ
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω cron –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –∏–º–ø–æ—Ä—Ç–∞: `/admin-import`
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ —Å–∞–π—Ç–µ
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ —Ä–∞–±–æ—Ç–∞ —Ä–∞–∑–º–µ—Ä–Ω—ã—Ö —Å–µ—Ç–æ–∫
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤

---

**üéâ –ì–æ—Ç–æ–≤–æ! –°–∏—Å—Ç–µ–º–∞ –∏–º–ø–æ—Ä—Ç–∞ Poizon –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç.**
