# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ - 05.11.2024, 10:15

## üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. ‚ùå Unknown Property: `related_products_json`
**–û—à–∏–±–∫–∞:**
```
Getting unknown property: app\models\Product::related_products_json
```

**–ü—Ä–∏—á–∏–Ω–∞:**
- –§—É–Ω–∫—Ü–∏—è `env()` –Ω–µ –±—ã–ª–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –∫–æ–Ω—Å–æ–ª—å–Ω—ã—Ö –∫–æ–º–∞–Ω–¥–∞—Ö (`console.php`)
- –ú–∏–≥—Ä–∞—Ü–∏–∏ –Ω–µ –ø—Ä–∏–º–µ–Ω–∏–ª–∏—Å—å –∏–∑-–∑–∞ —ç—Ç–æ–≥–æ

**–†–µ—à–µ–Ω–∏–µ:**
‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `require __DIR__ . '/bootstrap.php';` –≤ `config/console.php`
‚úÖ –ü—Ä–∏–º–µ–Ω–µ–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è `m251105_102000_ensure_new_fields_exist`

---

### 2. ‚ùå Unknown column 'is_active' in order_status
**–û—à–∏–±–∫–∞:**
```sql
SQLSTATE[42S22]: Column not found: 1054 Unknown column 'is_active' in 'where clause'
SELECT * FROM `order_status` WHERE `is_active` = 1 ORDER BY `sort`
```

**–ü—Ä–∏—á–∏–Ω–∞:**
- –ú–∏–≥—Ä–∞—Ü–∏—è `m251028_132700_add_is_active_to_order_status` –Ω–µ –±—ã–ª–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞
- –¢–∞–±–ª–∏—Ü–∞ `order_status` –Ω–µ —Å–æ–¥–µ—Ä–∂–∞–ª–∞ –ø–æ–ª–µ `is_active`

**–†–µ—à–µ–Ω–∏–µ:**
‚úÖ –°–æ–∑–¥–∞–Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è `m251105_103000_ensure_order_status_is_active`
‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `is_active` —Ç–∏–ø–∞ `boolean NOT NULL DEFAULT 1`
‚úÖ –í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å—Ç–∞—Ç—É—Å—ã —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∫–∞–∫ –∞–∫—Ç–∏–≤–Ω—ã–µ
‚úÖ –°–æ–∑–¥–∞–Ω –∏–Ω–¥–µ–∫—Å `idx-order_status-is_active`

---

### 3. ‚ö†Ô∏è PHP Warning: PDO
**–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ:**
```
PHP Warning: The use statement with non-compound name 'PDO' has no effect
```

**–ü—Ä–∏—á–∏–Ω–∞:**
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∏–º–ø–æ—Ä—Ç `use PDO;` –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–º namespace

**–†–µ—à–µ–Ω–∏–µ:**
‚úÖ –£–¥–∞–ª—ë–Ω `use PDO;`
‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –ø–æ–ª–Ω—ã–π namespace: `\PDO::ATTR_TIMEOUT`, `\PDO::ERRMODE_EXCEPTION`

---

## üìã –ü—Ä–∏–º–µ–Ω—ë–Ω–Ω—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏

```bash
php yii migrate/up
```

**–£—Å–ø–µ—à–Ω–æ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã:**
1. ‚úÖ `m251105_102000_ensure_new_fields_exist`
   - –î–æ–±–∞–≤–ª–µ–Ω—ã: `series_name`, `delivery_time_min/max`, `related_products_json` –≤ `product`
   - –î–æ–±–∞–≤–ª–µ–Ω—ã: `color_variant`, `delivery_time_min/max` –≤ `product_size`
   - –°–æ–∑–¥–∞–Ω—ã –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

2. ‚úÖ `m251105_103000_ensure_order_status_is_active`
   - –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `is_active` –≤ `order_status`
   - –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
   - –°–æ–∑–¥–∞–Ω –∏–Ω–¥–µ–∫—Å

**–û—á–∏—â–µ–Ω –∫—ç—à:**
```bash
php yii cache/flush-all
```

---

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### ‚úÖ –ê–¥–º–∏–Ω–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–∞
–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–π—Ç–∏ –≤ –∞–¥–º–∏–Ω–∫—É:
```
http://your-domain.com/admin
```
- ‚ùå –û—à–∏–±–∫–∞ `is_active` ‚Üí ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞
- ‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –°–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### ‚úÖ –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
```
http://your-domain.com/admin/edit-product?id=1
```
- ‚ùå –û—à–∏–±–∫–∞ `related_products_json` ‚Üí ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞
- ‚úÖ –§–æ—Ä–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
- ‚úÖ –ë–ª–æ–∫ "–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã" –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
- ‚úÖ –ú–æ–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–≤–∞—Ä –±–µ–∑ –æ—à–∏–±–æ–∫

### ‚úÖ –ö–∞—Ä—Ç–æ—á–∫–∞ —Ç–æ–≤–∞—Ä–∞ (–∫–ª–∏–µ–Ω—Ç)
```
http://your-domain.com/catalog/product/any-product
```
- ‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –¢–∞–±–ª–∏—Ü–∞ —Ä–∞–∑–º–µ—Ä–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç (–∫–Ω–æ–ø–∫–∞ toggle)
- ‚úÖ –°–µ–∫—Ü–∏—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≤—Å–µ –ø–æ–ª—è
- ‚úÖ –°—Ä–æ–∫–∏ –¥–æ—Å—Ç–∞–≤–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –µ—Å–ª–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã

---

## üìÇ –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:
1. **`config/console.php`** - –¥–æ–±–∞–≤–ª–µ–Ω bootstrap
2. **`config/db.php`** - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç PDO

### –ú–∏–≥—Ä–∞—Ü–∏–∏:
3. **`migrations/m251105_102000_ensure_new_fields_exist.php`** - –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª–µ–π
4. **`migrations/m251105_103000_ensure_order_status_is_active.php`** - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ is_active

---

## ‚úÖ –°—Ç–∞—Ç—É—Å

**–í—Å–µ –æ—à–∏–±–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã!**

| –ü—Ä–æ–±–ª–µ–º–∞ | –°—Ç–∞—Ç—É—Å |
|----------|--------|
| Unknown property: related_products_json | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ |
| Unknown column 'is_active' | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ |
| PHP Warning: PDO | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ |
| –ú–∏–≥—Ä–∞—Ü–∏–∏ | ‚úÖ –ü—Ä–∏–º–µ–Ω–µ–Ω—ã |
| –ö—ç—à | ‚úÖ –û—á–∏—â–µ–Ω |

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–û—Ç–∫—Ä–æ–π—Ç–µ –∞–¥–º–∏–Ω–∫—É** - —É–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç
2. **–û—Ç–∫—Ä–æ–π—Ç–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞** - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–æ–≤—ã–µ –ø–æ–ª—è
3. **–û—Ç–∫—Ä–æ–π—Ç–µ –∫–∞—Ä—Ç–æ—á–∫—É —Ç–æ–≤–∞—Ä–∞** - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–∞–±–ª–∏—Ü—É —Ä–∞–∑–º–µ—Ä–æ–≤
4. **–ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —Ç–æ–≤–∞—Ä—ã –∏–∑ Poizon** - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –∏–º–ø–æ—Ä—Ç–∞

---

---

### 4. ‚ùå Unknown column 'poizon_id' in product
**–û—à–∏–±–∫–∞:**
```sql
SQLSTATE[42S22]: Column not found: 1054 Unknown column 'poizon_id' in 'where clause'
SELECT COUNT(*) FROM `product` WHERE NOT (`poizon_id` IS NULL)
```

**–ü—Ä–∏—á–∏–Ω–∞:**
- –ú–∏–≥—Ä–∞—Ü–∏–∏ —Å Poizon –ø–æ–ª—è–º–∏ –Ω–µ –±—ã–ª–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã
- –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∏ –ø–æ–ª—è: `sku`, `poizon_id`, `poizon_spu_id`, `poizon_url`, –∏ –¥—Ä.

**–†–µ—à–µ–Ω–∏–µ:**
‚úÖ –°–æ–∑–¥–∞–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è `m251105_104000_ensure_poizon_fields_exist`
‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –≤—Å–µ 13 Poizon –ø–æ–ª–µ–π –≤ `product`:
  - `sku`, `poizon_id`, `poizon_spu_id`, `poizon_url`, `poizon_price_cny`
  - `last_sync_at`, `upper_material`, `sole_material`, `color_description`
  - `style_code`, `release_year`, `is_limited`, `weight`
‚úÖ –°–æ–∑–¥–∞–Ω—ã —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

‚úÖ –°–æ–∑–¥–∞–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è `m251105_104100_ensure_product_size_fields_exist`
‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è –≤ `product_size`:
  - –†–∞–∑–º–µ—Ä–Ω—ã–µ —Å–µ—Ç–∫–∏: `us_size`, `eu_size`, `uk_size`, `cm_size`
  - Poizon –ø–æ–ª—è: `poizon_sku_id`, `poizon_stock`, `poizon_price_cny`
  - –¶–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ: `price_cny`, `price_byn`
  - Timestamps: `created_at`, `updated_at`
‚úÖ –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–æ `stock_quantity` ‚Üí `stock`

---

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** 05.11.2024, 10:07-10:18 (~11 –º–∏–Ω—É—Ç)  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–°–Å –†–ê–ë–û–¢–ê–ï–¢!**
