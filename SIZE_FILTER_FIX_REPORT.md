# –û—Ç—á–µ—Ç: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞ —Ä–∞–∑–º–µ—Ä–æ–≤ CM

## –î–∞—Ç–∞: 08.11.2025, 22:09

---

## üî¥ –ü—Ä–æ–±–ª–µ–º–∞

–í —Ñ–∏–ª—å—Ç—Ä–µ —Ä–∞–∑–º–µ—Ä–æ–≤ (CM) –æ—Ç–æ–±—Ä–∞–∂–∞–ª–∏—Å—å **–Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è**:
- 220.0 —Å–º
- 235.0 —Å–º  
- 35.5, 36.0, 37.0, 38.0 —Å–º (–±–æ–ª—å—à–µ –¥–æ–ø—É—Å—Ç–∏–º–æ–≥–æ)
- 16.5, 17.0, 17.5, 18.0, 18.5, 19.0 —Å–º (–º–µ–Ω—å—à–µ –¥–æ–ø—É—Å—Ç–∏–º–æ–≥–æ)

**–ü—Ä–∏—á–∏–Ω–∞:** 
–û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∏–∞–ø–∞–∑–æ–Ω–∞ —Ä–∞–∑–º–µ—Ä–æ–≤ –æ–±—É–≤–∏ –≤ —Å–º. –ù–æ—Ä–º–∞–ª—å–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω: **20-35 —Å–º**.

---

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≤ `CatalogController::getAvailableSizes()`

**–§–∞–π–ª:** `controllers/CatalogController.php`

```php
// –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –§–∏–ª—å—Ç—Ä—É–µ–º –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã (–Ω–æ—Ä–º–∞–ª—å–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω 20-35 —Å–º)
->andWhere(['>=', 'product_size.cm_size', 20])
->andWhere(['<=', 'product_size.cm_size', 35])
```

–¢–µ–ø–µ—Ä—å —Ñ–∏–ª—å—Ç—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç **—Ç–æ–ª—å–∫–æ —Ä–∞–∑–º–µ—Ä—ã –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ 20-35 —Å–º**.

---

### 2. –£–ª—É—á—à–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `normalizeCmSize()` —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π

**–§–∞–π–ª—ã:** 
- `commands/PoizonImportController.php`
- `commands/PoizonImportJsonController.php`

**–ë—ã–ª–æ:**
```php
if ($cmSize >= 100) {
    return $cmSize / 10;
}
return $cmSize;
```

**–°—Ç–∞–ª–æ:**
```php
if ($cmSize >= 100) {
    $cmSize = $cmSize / 10;
}

// –í–ê–õ–ò–î–ê–¶–ò–Ø: –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω —Ä–∞–∑–º–µ—Ä–æ–≤ –æ–±—É–≤–∏ –≤ —Å–º: 20-35
if ($cmSize < 20 || $cmSize > 35) {
    \Yii::warning("–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ä–∞–∑–º–µ—Ä CM: {$cmSize}, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º", 'import');
    return null; // –û—Ç–±—Ä–∞—Å—ã–≤–∞–µ–º –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
}

return $cmSize;
```

–¢–µ–ø–µ—Ä—å –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ **–Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è**.

---

### 3. –°–æ–∑–¥–∞–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ –æ—á–∏—Å—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö

**–§–∞–π–ª:** `commands/CleanSizesController.php` ‚ú® **–ù–û–í–´–ô**

**–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:**
```bash
./yii clean-sizes/stats  # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–∞–∑–º–µ—Ä–æ–≤
./yii clean-sizes/cm     # –û—á–∏—Å—Ç–∫–∞ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤ CM
```

---

### 4. –û—á–∏—â–µ–Ω—ã –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –ë–î

**–†–µ–∑—É–ª—å—Ç–∞—Ç –æ—á–∏—Å—Ç–∫–∏:**
```
–ù–∞–π–¥–µ–Ω–æ 37 –∑–∞–ø–∏—Å–µ–π —Å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ —Ä–∞–∑–º–µ—Ä–∞–º–∏ CM:
  ‚Ä¢ 35.5 —Å–º: 10 –∑–∞–ø–∏—Å–µ–π
  ‚Ä¢ 36.0 —Å–º: 10 –∑–∞–ø–∏—Å–µ–π
  ‚Ä¢ 17.0 —Å–º: 3 –∑–∞–ø–∏—Å–µ–π
  ‚Ä¢ 19.0 —Å–º: 3 –∑–∞–ø–∏—Å–µ–π
  ‚Ä¢ 16.5 —Å–º: 2 –∑–∞–ø–∏—Å–µ–π
  ‚Ä¢ 17.5 —Å–º: 2 –∑–∞–ø–∏—Å–µ–π
  ‚Ä¢ 18.5 —Å–º: 2 –∑–∞–ø–∏—Å–µ–π
  ‚Ä¢ 37.0 —Å–º: 2 –∑–∞–ø–∏—Å–µ–π
  ‚Ä¢ 38.0 —Å–º: 2 –∑–∞–ø–∏—Å–µ–π
  ‚Ä¢ 18.0 —Å–º: 1 –∑–∞–ø–∏—Å–µ–π

‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–æ 37 –∑–∞–ø–∏—Å–µ–π (—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ cm_size = NULL)
‚úÖ –ö—ç—à –æ—á–∏—â–µ–Ω
```

---

## üìä –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

**–ü–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏:**
- –í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π CM: **5098**
- –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤: **29**
- –î–∏–∞–ø–∞–∑–æ–Ω: **20.0 - 35.0 —Å–º** ‚úÖ
- –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤: **0** ‚úÖ

**–¢–æ–ø-10 —Ä–∞–∑–º–µ—Ä–æ–≤:**
1. 25.0 —Å–º ‚Äî 370 –∑–∞–ø–∏—Å–µ–π ‚úÖ
2. 25.5 —Å–º ‚Äî 351 –∑–∞–ø–∏—Å–µ–π ‚úÖ
3. 26.0 —Å–º ‚Äî 327 –∑–∞–ø–∏—Å–µ–π ‚úÖ
4. 26.5 —Å–º ‚Äî 320 –∑–∞–ø–∏—Å–µ–π ‚úÖ
5. 27.0 —Å–º ‚Äî 320 –∑–∞–ø–∏—Å–µ–π ‚úÖ
6. 24.5 —Å–º ‚Äî 318 –∑–∞–ø–∏—Å–µ–π ‚úÖ
7. 27.5 —Å–º ‚Äî 311 –∑–∞–ø–∏—Å–µ–π ‚úÖ
8. 28.0 —Å–º ‚Äî 310 –∑–∞–ø–∏—Å–µ–π ‚úÖ
9. 24.0 —Å–º ‚Äî 296 –∑–∞–ø–∏—Å–µ–π ‚úÖ
10. 23.5 —Å–º ‚Äî 291 –∑–∞–ø–∏—Å–µ–π ‚úÖ

---

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

‚úÖ **–§–∏–ª—å—Ç—Ä —Ä–∞–∑–º–µ—Ä–æ–≤ CM —Ç–µ–ø–µ—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (20-35 —Å–º)**

‚úÖ **–ü—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ –Ω–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è**

‚úÖ **–°—Ç–∞—Ä—ã–µ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—á–∏—â–µ–Ω—ã –∏–∑ –ë–î**

‚úÖ **–°–æ–∑–¥–∞–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ –æ—á–∏—Å—Ç–∫–∏ —Ä–∞–∑–º–µ—Ä–æ–≤ –≤ –±—É–¥—É—â–µ–º**

---

## üìù –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. `controllers/CatalogController.php` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∏–∞–ø–∞–∑–æ–Ω–∞
2. `commands/PoizonImportController.php` ‚Äî —É–ª—É—á—à–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è
3. `commands/PoizonImportJsonController.php` ‚Äî —É–ª—É—á—à–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è
4. `commands/CleanSizesController.php` ‚Äî **–°–û–ó–î–ê–ù** (–Ω–æ–≤–∞—è –∫–æ–º–∞–Ω–¥–∞)

---

## üîÆ –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã

1. **–í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ** ‚Äî –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è
2. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø—Ä–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏** ‚Äî –¥–∞–∂–µ –µ—Å–ª–∏ –ø–æ–ø–∞–¥—É—Ç –≤ –ë–î, –Ω–µ –ø–æ–∫–∞–∂—É—Ç—Å—è –≤ —Ñ–∏–ª—å—Ç—Ä–µ
3. **–ö–æ–º–∞–Ω–¥–∞ –æ—á–∏—Å—Ç–∫–∏** ‚Äî –º–æ–∂–Ω–æ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –∏ —á–∏—Å—Ç–∏—Ç—å –¥–∞–Ω–Ω—ã–µ

**–ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:**
```bash
./yii clean-sizes/stats  # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
./yii clean-sizes/cm     # –û—á–∏—Å—Ç–∏—Ç—å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ (–µ—Å–ª–∏ –ø–æ—è–≤—è—Ç—Å—è)
```

---

**–ü—Ä–æ–±–ª–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω–∞!** ‚úÖ
