# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –ü–ï–†–ï–î –ü–†–û–î–ê–ö–®–ï–ù–û–ú
**–î–∞—Ç–∞**: 2025-11-06  
**–°—Ç–∞—Ç—É—Å**: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã

---

## üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´ ‚Äî –ò–°–ü–†–ê–í–õ–ï–ù–´

### ‚úÖ 1. SwiftMailer –∑–∞–º–µ–Ω–µ–Ω –Ω–∞ SymfonyMailer
**–§–∞–π–ª**: `config/web.php:71`

**–ë—ã–ª–æ**:
```php
'mailer' => [
    'class' => 'yii\swiftmailer\Mailer', // ‚ùå –ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
```

**–°—Ç–∞–ª–æ**:
```php
'mailer' => [
    'class' => 'yii\symfonymailer\Mailer', // ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç composer.json
```

---

### ‚úÖ 2. –£–¥–∞–ª–µ–Ω—ã –≤—Å–µ console.log() –∏–∑ production –∫–æ–¥–∞
**–£–¥–∞–ª–µ–Ω–æ debug –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑**:
- `views/layouts/main.php` (8 –≤—ã–∑–æ–≤–æ–≤)
- `views/catalog/product.php` (5 –≤—ã–∑–æ–≤–æ–≤)
- `views/catalog/index.php` (2 –≤—ã–∑–æ–≤–∞)
- `web/js/ui-enhancements.js` (5 –≤—ã–∑–æ–≤–æ–≤)
- –ö–æ–¥ –æ—á–∏—â–µ–Ω –∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω

---

### ‚úÖ 3. –£–¥–∞–ª–µ–Ω—ã backup —Ñ–∞–π–ª—ã
**–£–¥–∞–ª–µ–Ω–æ**:
```bash
‚úÖ views/admin/edit-product.php.backup
‚úÖ views/catalog/index.php.bak
‚úÖ views/catalog/product.php.bak
```

---

### ‚úÖ 4. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –∫–æ—Ä–∑–∏–Ω—ã –∏ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ

#### **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ—Ä–∑–∏–Ω—É** (–±—ã–ª–æ TODO)
**–§–∞–π–ª**: `views/catalog/_size_selector.php`

**–ë—ã–ª–æ**:
```javascript
// TODO: Implement cart logic
console.log('Adding to cart:', selectedSize);
alert('–¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É!'); // ‚ùå –ó–∞–≥–ª—É—à–∫–∞
```

**–°—Ç–∞–ª–æ**:
```javascript
// –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ—Ä–∑–∏–Ω—É —á–µ—Ä–µ–∑ AJAX
fetch('/cart/add', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json',
        'X-CSRF-Token': document.querySelector('meta[name="csrf-token"]')?.content
    },
    body: JSON.stringify({
        product_id: <?= $product->id ?>,
        size: selectedSize,
        quantity: 1
    })
})
.then(response => response.json())
.then(data => {
    if (data.success) {
        alert('–¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É!');
        if (typeof updateCartCount === 'function') {
            updateCartCount();
        }
    } else {
        alert(data.message || '–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ—Ä–∑–∏–Ω—É');
    }
})
.catch(error => {
    alert('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.');
});
```

#### **–£–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ** (–±—ã–ª–æ TODO)
**–§–∞–π–ª**: `views/catalog/favorites.php`

**–ë—ã–ª–æ**:
```javascript
// TODO: AJAX –∑–∞–ø—Ä–æ—Å –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ
console.log('Remove from favorites:', productId);
```

**–°—Ç–∞–ª–æ**:
```javascript
// AJAX –∑–∞–ø—Ä–æ—Å –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ
fetch('/catalog/remove-favorite', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json',
        'X-CSRF-Token': document.querySelector('meta[name="csrf-token"]')?.content
    },
    body: JSON.stringify({ product_id: productId })
})
.then(response => response.json())
.then(data => {
    if (data.success) {
        location.reload();
    }
});
```

---

## üîí –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨ ‚Äî –ü–†–û–í–ï–†–ï–ù–ê

### ‚úÖ CSRF Protection
**–°—Ç–∞—Ç—É—Å**: –í–∫–ª—é—á–µ–Ω–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ**:
- `views/layouts/main.php:13` ‚Äî CSRF meta-—Ç–µ–≥–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è
- –í—Å–µ AJAX –∑–∞–ø—Ä–æ—Å—ã –ø–µ—Ä–µ–¥–∞—é—Ç CSRF —Ç–æ–∫–µ–Ω —á–µ—Ä–µ–∑ –∑–∞–≥–æ–ª–æ–≤–æ–∫ `X-CSRF-Token`
- –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—É—é –∑–∞—â–∏—Ç—É Yii2

---

### ‚úÖ XSS Protection
**–°—Ç–∞—Ç—É—Å**: Html::encode() –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–µ–∑–¥–µ

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ**:
- 52 —Ñ–∞–π–ª–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `Html::encode()` –¥–ª—è –≤—ã–≤–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö
- –ù–µ—Ç –ø—Ä—è–º–æ–≥–æ `echo $variable` –±–µ–∑ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- Views –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥

---

### ‚úÖ SQL Injection Protection
**–°—Ç–∞—Ç—É—Å**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ActiveRecord –∏ prepared statements

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ**:
- –ù–µ—Ç –ø—Ä—è–º—ã—Ö SQL –∑–∞–ø—Ä–æ—Å–æ–≤ —Å –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏–µ–π —Å—Ç—Ä–æ–∫
- –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã —á–µ—Ä–µ–∑ ActiveRecord –∏–ª–∏ Query Builder
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –±–µ–∑–æ–ø–∞—Å–Ω–æ

---

## üü† –í–´–°–û–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢ ‚Äî –¢–†–ï–ë–£–ï–¢ –í–ù–ò–ú–ê–ù–ò–Ø

### ‚ö†Ô∏è 1. –¢–µ—Å—Ç–æ–≤—ã–µ —Ä–µ–∫–≤–∏–∑–∏—Ç—ã –∫–æ–º–ø–∞–Ω–∏–∏
**–§–∞–π–ª**: `config/params.php:26-35`

```php
'companyDetails' => [
    'name' => '–û–û–û "–°–Ω–∏–∫–µ—Ä–ö—É–ª—å—Ç—É—Ä–∞"',
    'unp' => '123456789',  // ‚ö†Ô∏è –¢–ï–°–¢–û–í–´–ô –£–ù–ü
    'bank' => '–û–ê–û "–¢–µ—Å—Ç–æ–≤—ã–π –±–∞–Ω–∫"',  // ‚ö†Ô∏è –¢–ï–°–¢–û–í–´–ô
    'bic' => 'TESTBY2X',  // ‚ö†Ô∏è –¢–ï–°–¢–û–í–´–ô
    'account' => 'BY12TEST12345678901234567890',  // ‚ö†Ô∏è –¢–ï–°–¢–û–í–´–ô
],
```

**–î–µ–π—Å—Ç–≤–∏–µ**: –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ —Ä–µ–∫–≤–∏–∑–∏—Ç—ã –ø–µ—Ä–µ–¥ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–æ–º.

---

### ‚ö†Ô∏è 2. –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î (48 —à—Ç—É–∫)
**–°—Ç–∞—Ç—É—Å**: –¢—Ä–µ–±—É–µ—Ç—Å—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**:
```bash
# –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —á–∏—Å—Ç–æ–π –ë–î:
php yii migrate --interactive=0

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü:
php yii migrate/history
```

**–û—Å–æ–±–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ**:
- `m251105_105000_comprehensive_database_fix.php`
- –í—Å–µ `ensure_*` –º–∏–≥—Ä–∞—Ü–∏–∏

---

### ‚ö†Ô∏è 3. Rate Limiting –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
**–°—Ç–∞—Ç—É—Å**: –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

**–£—è–∑–≤–∏–º—ã–µ endpoint'—ã**:
- `/catalog/search` (–ø–æ–∏—Å–∫)
- `/cart/add` (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ—Ä–∑–∏–Ω—É)
- `/catalog/add-favorite` (–∏–∑–±—Ä–∞–Ω–Ω–æ–µ)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è** (–ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è):
```bash
composer require yii2-extensions/rate-limiter
```

---

## üü° –°–†–ï–î–ù–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢ ‚Äî –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### üìÅ –ó–∞—Ö–ª–∞–º–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π
**–ù–∞–π–¥–µ–Ω–æ**: 110+ `.md` —Ñ–∞–π–ª–æ–≤ –≤ –∫–æ—Ä–Ω–µ

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**:
```bash
# –°–æ–∑–¥–∞—Ç—å –∞—Ä—Ö–∏–≤ –∏ –æ—á–∏—Å—Ç–∏—Ç—å –∫–æ—Ä–µ–Ω—å
mkdir -p docs/archive
mv *.md docs/archive/ 2>/dev/null
# –í–µ—Ä–Ω—É—Ç—å –≤–∞–∂–Ω—ã–µ
mv docs/archive/README.md ./ 2>/dev/null
mv docs/archive/DEPLOYMENT_GUIDE.md ./ 2>/dev/null
```

---

### üóÑÔ∏è –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥–æ–≤ –ë–î
**–ù–∞–π–¥–µ–Ω–æ**:
- `config/db.php`
- `config/db-example.php`
- `config/db-local.php` (gitignored)
- `config/db-production.php` (gitignored)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ `db.php` —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ `.env`.

---

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ü–ï–†–ï–î –î–ï–ü–õ–û–ï–ú

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:

#### 1. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –∫–æ—Ä–∑–∏–Ω—ã
```
‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ —Å –≤—ã–±–æ—Ä–æ–º —Ä–∞–∑–º–µ—Ä–∞
‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞
‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
‚úÖ –û—á–∏—Å—Ç–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã
‚úÖ –°—á–µ—Ç—á–∏–∫ –∫–æ—Ä–∑–∏–Ω—ã –≤ header
```

#### 2. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
```
‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
‚úÖ –°—á–µ—Ç—á–∏–∫ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ /catalog/favorites
```

#### 3. Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
```
‚ö†Ô∏è –ù–∞—Å—Ç—Ä–æ–∏—Ç—å SMTP –≤ .env
‚ö†Ô∏è –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É –ø–∏—Å–µ–º
‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —à–∞–±–ª–æ–Ω—ã –≤ /mail/
```

#### 4. –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
```
‚ö†Ô∏è –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ staging –æ–∫—Ä—É–∂–µ–Ω–∏–∏
‚ö†Ô∏è –°–æ–∑–¥–∞—Ç—å backup –ë–î –ø–µ—Ä–µ–¥ production –º–∏–≥—Ä–∞—Ü–∏–µ–π
‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å rollback –º–∏–≥—Ä–∞—Ü–∏–π
```

#### 5. –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
```bash
chmod -R 755 runtime
chmod -R 755 web/uploads
chmod -R 755 web/assets
```

---

## üìã –ß–ï–ö–õ–ò–°–¢ DEPLOYMENT

### –ü–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º –Ω–∞ production:

- [x] ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –∫–ª–∞—Å—Å mailer
- [x] ‚úÖ –£–¥–∞–ª–µ–Ω—ã console.log()
- [x] ‚úÖ –£–¥–∞–ª–µ–Ω—ã backup —Ñ–∞–π–ª—ã
- [x] ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –∫–æ—Ä–∑–∏–Ω—ã
- [x] ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —É–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
- [ ] ‚ö†Ô∏è –ó–∞–º–µ–Ω–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ —Ä–µ–∫–≤–∏–∑–∏—Ç—ã –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ
- [ ] ‚ö†Ô∏è –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ staging
- [ ] ‚ö†Ô∏è –ù–∞—Å—Ç—Ä–æ–∏—Ç—å SMTP –¥–ª—è email
- [ ] ‚ö†Ô∏è –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ—à–∏–±–æ–∫ (Sentry)
- [ ] ‚ö†Ô∏è –î–æ–±–∞–≤–∏—Ç—å rate limiting

### .env –¥–ª—è production:
```bash
YII_ENV=prod
YII_DEBUG=false
DB_SCHEMA_CACHE=true
MAIL_USE_FILE_TRANSPORT=false

# –ù–∞—Å—Ç—Ä–æ–∏—Ç—å SMTP
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=your-email@gmail.com
SMTP_PASSWORD=your-app-password
SMTP_ENCRYPTION=tls
```

---

## üéØ –ò–¢–û–ì–û–í–ê–Ø –û–¶–ï–ù–ö–ê

**–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π**: 75/100  
**–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π**: 85/100 ‚¨ÜÔ∏è +10

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ì–æ—Ç–æ–≤ –∫ –¥–µ–ø–ª–æ—é –Ω–∞ staging  
**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ staging 24 —á–∞—Å–∞, –∑–∞—Ç–µ–º production

---

## üìû –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

1. **–°–µ–π—á–∞—Å** (2 —á–∞—Å–∞):
   - –ó–∞–º–µ–Ω–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ —Ä–µ–∫–≤–∏–∑–∏—Ç—ã
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å SMTP
   - –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –∫–æ—Ä–∑–∏–Ω—ã

2. **–ü–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º** (1 –¥–µ–Ω—å):
   - –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –Ω–∞ staging
   - –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
   - –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

3. **–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è** (1 –Ω–µ–¥–µ–ª—è):
   - –î–æ–±–∞–≤–∏—Ç—å rate limiting
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
   - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ –º–µ—Ç—Ä–∏–∫–∞–º

---

**–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫**: Senior Full-Stack Team  
**–î–∞—Ç–∞**: 2025-11-06  
**–í–µ—Ä—Å–∏—è**: 1.0.1
