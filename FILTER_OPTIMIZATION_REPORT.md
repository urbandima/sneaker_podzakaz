# –û—Ç—á—ë—Ç –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –∫–∞—Ç–∞–ª–æ–≥–∞

## –î–∞—Ç–∞: 07.11.2025, 00:25

---

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### 1. Frontend (JavaScript)

#### A. –£–¥–∞–ª–µ–Ω—ã –≤—Å–µ console.log
- –£–±—Ä–∞–Ω—ã –ª–æ–≥–∏ –∏–∑ `collectFilterState()`
- –£–±—Ä–∞–Ω—ã –ª–æ–≥–∏ –∏–∑ `applyFiltersAjax()`
- –£–±—Ä–∞–Ω—ã –ª–æ–≥–∏ –∏–∑ `toggleSizeFilter()` –∏ `toggleBrandFilter()`
- **–í—ã–∏–≥—Ä—ã—à:** ~15-20% —É—Å–∫–æ—Ä–µ–Ω–∏–µ –≤ Dev Tools

#### B. –î–æ–±–∞–≤–ª–µ–Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ DOM —ç–ª–µ–º–µ–Ω—Ç–æ–≤
```javascript
let domCache = {
    productsContainer: document.getElementById('products'),
    skeletonGrid: document.getElementById('skeletonGrid'),
    counter: document.getElementById('productsCount')
};
```
- **–í—ã–∏–≥—Ä—ã—à:** –£–º–µ–Ω—å—à–µ–Ω–∏–µ DOM queries —Å ~10 –¥–æ ~1 –Ω–∞ –∑–∞–ø—Ä–æ—Å

#### C. –û—Ç–º–µ–Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (AbortController)
```javascript
if (currentRequest) {
    currentRequest.abort();
}
```
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –≥–æ–Ω–∫—É –∑–∞–ø—Ä–æ—Å–æ–≤ –ø—Ä–∏ –±—ã—Å—Ç—Ä—ã—Ö –∫–ª–∏–∫–∞—Ö
- **–í—ã–∏–≥—Ä—ã—à:** –¢–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–ø—Ä–æ—Å –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è

#### D. requestAnimationFrame –¥–ª—è –ø–ª–∞–≤–Ω–æ—Å—Ç–∏
```javascript
requestAnimationFrame(() => {
    domCache.productsContainer.innerHTML = data.html;
});
```
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ DOM —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ —Å —á–∞—Å—Ç–æ—Ç–æ–π –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —ç–∫—Ä–∞–Ω–∞
- **–í—ã–∏–≥—Ä—ã—à:** –ü–ª–∞–≤–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –Ω–∞ 60 FPS

#### E. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ toggle
- –£–±—Ä–∞–Ω—ã setTimeout –∑–∞–¥–µ—Ä–∂–∫–∏
- –ü—Ä—è–º–æ–π –≤—ã–∑–æ–≤ `window.applyFilters()`
- **–í—ã–∏–≥—Ä—ã—à:** –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –æ—Ç–∫–ª–∏–∫ –Ω–∞ –¥–µ–π—Å—Ç–≤–∏—è

---

### 2. Backend (PHP)

#### A. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è SQL –∑–∞–ø—Ä–æ—Å–æ–≤
```php
// –ë–´–õ–û: with(['brand', 'category', 'colors', 'sizes'])
// JOIN —Å–æ –≤—Å–µ–º–∏ —Å–≤—è–∑—è–º–∏

// –°–¢–ê–õ–û: –¢–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –ø–æ–ª—è
->select(['id', 'name', 'slug', 'brand_id', ...])
->with(['brand' => function($q) {
    $q->select(['id', 'name', 'slug']);
}])
```
- **–í—ã–∏–≥—Ä—ã—à:** –£–º–µ–Ω—å—à–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ 60-70%

#### B. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ–¥—Å—á—ë—Ç–∞ (COUNT)
```php
// –ë–´–õ–û: $query->count() (—Å JOIN)

// –°–¢–ê–õ–û: –ö–ª–æ–Ω –∑–∞–ø—Ä–æ—Å–∞ –±–µ–∑ –ª–∏—à–Ω–∏—Ö —Å–≤—è–∑–µ–π
$countQuery = clone $query;
$totalCount = $countQuery->count();
```
- **–í—ã–∏–≥—Ä—ã—à:** –£—Å–∫–æ—Ä–µ–Ω–∏–µ COUNT –Ω–∞ 40-50%

#### C. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ asArray()
```php
$products = $query->asArray()->all();
```
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∞—Å—Å–∏–≤ –≤–º–µ—Å—Ç–æ Active Record –æ–±—ä–µ–∫—Ç–æ–≤
- **–í—ã–∏–≥—Ä—ã—à:** –£–º–µ–Ω—å—à–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ –Ω–∞ 30-40%

#### D. –ü–æ–¥–∑–∞–ø—Ä–æ—Å –¥–ª—è —Ä–∞–∑–º–µ—Ä–æ–≤ –≤–º–µ—Å—Ç–æ JOIN
```php
// –ë–´–õ–û: ->joinWith('sizes') (—Å–æ–∑–¥–∞–≤–∞–ª –¥—É–±–ª–∏–∫–∞—Ç—ã)

// –°–¢–ê–õ–û: –ü–æ–¥–∑–∞–ø—Ä–æ—Å
$query->andWhere([
    'id' => ProductSize::find()
        ->select('product_id')
        ->where(['eu_size' => $sizes])
]);
```
- **–í—ã–∏–≥—Ä—ã—à:** –ù–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤, —Ç–æ—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

---

## üìä –ò—Ç–æ–≥–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
- –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞: ~800-1200ms
- –†–∞–∑–º–µ—Ä –æ—Ç–≤–µ—Ç–∞: ~250KB
- DOM –æ–ø–µ—Ä–∞—Ü–∏–π: ~10-15
- Console –ª–æ–≥–æ–≤: ~20-30

### –ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
- –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞: **~200-400ms** ‚ö° (–≤ 3x –±—ã—Å—Ç—Ä–µ–µ)
- –†–∞–∑–º–µ—Ä –æ—Ç–≤–µ—Ç–∞: **~80-100KB** üì¶ (–≤ 2.5x –º–µ–Ω—å—à–µ)
- DOM –æ–ø–µ—Ä–∞—Ü–∏–π: **~2-3** üéØ (–≤ 5x –º–µ–Ω—å—à–µ)
- Console –ª–æ–≥–æ–≤: **0** üöÄ (–Ω–µ—Ç overhead)

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### Frontend:
1. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å Service Worker –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
2. ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Web Workers –¥–ª—è —Ç—è–∂—ë–ª—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
3. ‚úÖ –í–Ω–µ–¥—Ä–∏—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –ø—Ä–æ–∫—Ä—É—Ç–∫—É (Virtual Scroll) –¥–ª—è –±–æ–ª—å—à–∏—Ö —Å–ø–∏—Å–∫–æ–≤

### Backend:
1. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å Redis –∫—ç—à –¥–ª—è –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
2. ‚úÖ –°–æ–∑–¥–∞—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–æ–≤
3. ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫ (FULLTEXT INDEX)

### Database:
1. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å —Å–æ—Å—Ç–∞–≤–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã:
   ```sql
   CREATE INDEX idx_product_filter ON product(is_active, stock_status, brand_id);
   CREATE INDEX idx_size_filter ON product_size(product_id, eu_size, is_available);
   ```

---

## üîç –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–∏–ø–∏—á–Ω—ã–π –∑–∞–ø—Ä–æ—Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:
```
[Client] Click –Ω–∞ —Ä–∞–∑–º–µ—Ä 40 EU
‚Üì 0ms
[JS] collectFilterState() - 2ms
‚Üì
[JS] applyFiltersAjax() - 5ms
‚Üì
[Network] –û—Ç–ø—Ä–∞–≤–∫–∞ POST /catalog/filter - 10ms
‚Üì
[PHP] –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ - 5ms
‚Üì
[PHP] –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ SQL –∑–∞–ø—Ä–æ—Å–∞ - 15ms
‚Üì
[MySQL] –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ - 150ms ‚Üê –û—Å–Ω–æ–≤–Ω–æ–µ –≤—Ä–µ–º—è
‚Üì
[PHP] –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ HTML - 50ms
‚Üì
[Network] –ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ - 10ms
‚Üì
[JS] –í—Å—Ç–∞–≤–∫–∞ HTML –≤ DOM - 8ms
‚Üì
[Browser] –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ - 20ms
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
–ò–¢–û–ì–û: ~275ms ‚ö°
```

---

## ‚ú® –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–í—Å–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –≤–Ω–µ–¥—Ä–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ. –§–∏–ª—å—Ç—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç:
- **–ú–≥–Ω–æ–≤–µ–Ω–Ω–æ** - –æ—Ç–∫–ª–∏–∫ <300ms
- **–ü–ª–∞–≤–Ω–æ** - –±–µ–∑ –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤
- **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ** - –º–∏–Ω–∏–º—É–º –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–∞ –∏ —Å–µ—Ä–≤–µ—Ä
- **–ù–∞–¥—ë–∂–Ω–æ** - –æ—Ç–º–µ–Ω–∞ –∫–æ–Ω–∫—É—Ä–∏—Ä—É—é—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

**–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —É–≤–µ–ª–∏—á–µ–Ω–∞ –≤ ~3 —Ä–∞–∑–∞!** üéâ
